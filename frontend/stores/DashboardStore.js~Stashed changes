// @flow
import { observable, action, runInAction } from 'mobx';
import { client } from 'utils/ApiClient';

class DashboardStore {
  @observable collections: Object;
  @observable pagination: Object;

  @observable isFetching: boolean = true;

  /* Actions */

  @action fetchCollections = async () => {
    this.isFetching = true;

    try {
      const res = await client.post('/collections.list', { id: this.team.id });
      const { data, pagination } = res;
      runInAction('fetchCollections', () => {
        this.collections = data;
        this.pagination = pagination;
      });

      // // If only one collection, visit it automatically
      // if (this.collections.length === 1) {
      //   this.router.push(this.collections[0].url);
      // }
    } catch (e) {
      console.error('Something went wrong');
    }
    this.isFetching = false;
  };

  constructor(options) {
    this.team = options.team;
    this.router = options.router;
  }
}

export default DashboardStore;
